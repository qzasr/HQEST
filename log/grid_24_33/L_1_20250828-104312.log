time_slot=15, torch_seed=42, num_link=223, num_his=8, num_pred=8, L=1, K=8, d=8, train_ratio=0.7, val_ratio=0.1, test_ratio=0.2, batch_size=8, max_epoch=100, patience=10, learning_rate=0.009, decay_epoch=16, bn_decay=0.1, drop=0.01, traffic_file='./data/Traffic_speed_(24, 33).csv', query_file='./data/query_beijing_0201_grid_start_destination_count.npz', SE_file='./data/Gf_grid_24_33_id.txt', adj_file='./data/edge_list_grid_(24,33)_weight.txt', row='24', col='33', model_file='./save_model/grid_24_33/Model_GF_test.pkl', log_file='./log/grid_24_33/log_test', SE_FC_bn_decay=0.1, SE_FC_act1='relu', SE_FC_act2='none', SE_FC_drop=0.01, TE_FC_bn_decay=0.1, TE_FC_act1='relu', TE_FC_act2='none', TE_FC_drop=0.01, FFT_bn_decay=0.1, FFT_FC_act1='relu', FFT_FC_act2='none', FFT_FC_drop=0.01, SA_Q_bn_decay=0.1, SA_Q_act='relu', SA_Q_drop=0.01, SA_K_bn_decay=0.1, SA_K_act='relu', SA_K_drop=0.01, SA_V_bn_decay=0.1, SA_V_act='relu', SA_V_drop=0.01, SA_FC_bn_decay=0.1, SA_FC_act='relu', SA_FC_drop=0.01, GMF_bn_decay=0.1, AUX_aux_bn_decay=0.1, AUX_aux_act1='relu', AUX_aux_act2='none', AUX_aux_drop=0.01, AUX_main_bn_decay=0.1, AUX_main_act1='relu', AUX_main_act2='none', AUX_main_drop=0.01, AUX_sim_bn_decay=0.1, AUX_sim_act1='relu', AUX_sim_act2='sigmoid', AUX_sim_drop=0.01, AUX_attn_bn_decay=0.1, AUX_attn_act1='relu', AUX_attn_act2='none', AUX_attn_drop=0.01, AUX_fusion_bn_decay=0.1, AUX_fusion_act1='relu', AUX_fusion_act2='none', AUX_fusion_drop=0.01, AUX_bn_decay=0.1, TA_Q_bn_decay=0.1, TA_Q_act='relu', TA_Q_drop=0.01, TA_K_bn_decay=0.1, TA_K_act='relu', TA_K_drop=0.01, TA_V_bn_decay=0.1, TA_V_act='relu', TA_V_drop=0.01, TA_fusion_bn_decay=0.1, TA_fusion_act='relu', TA_fusion_drop=0.01, NAV_Q_bn_decay=0.1, NAV_Q_act='relu', NAV_Q_drop=0.01, NAV_K_bn_decay=0.1, NAV_K_act='relu', NAV_K_drop=0.01, NAV_V_bn_decay=0.1, NAV_V_act='relu', NAV_V_drop=0.01, NAV_MAP_bn_decay=0.1, NAV_MAP_act='relu', NAV_MAP_drop=0.01, NAV_FUSION_bn_decay=0.1, NAV_FUSION_act='relu', NAV_FUSION_drop=0.01, STB_spatial_fusion_bn_decay=0.1, STB_spatial_fusion_act='relu', STB_spatial_fusion_drop=0.01, STB_temporal_fusion_bn_decay=0.1, STB_temporal_fusion_act='relu', STB_temporal_fusion_drop=0.01, STB_final_fusion_bn_decay=0.1, STB_final_fusion_act='relu', STB_final_fusion_drop=0.01, STB_gate_bn_decay=0.1, STB_gate_act1='relu', STB_gate_act2='sigmoid', STB_gate_drop=0.01, TA_transform_Q_bn_decay=0.1, TA_transform_Q_act='relu', TA_transform_Q_drop=0.0, TA_transform_K_bn_decay=0.1, TA_transform_K_act='relu', TA_transform_K_drop=0.0, TA_transform_V_bn_decay=0.1, TA_transform_V_act='relu', TA_transform_V_drop=0.0, TA_transform_FC_bn_decay=0.1, TA_transform_FC_act='relu', TA_transform_FC_drop=0.0, Traffic_Linear_bn_decay=0.1, Traffic_Linear_FC_act1='relu', Traffic_Linear_FC_act2='none', Traffic_Linear_FC_drop=0.01, Query_Linear_bn_decay=0.1, Query_Linear_FC_act1='relu', Query_Linear_FC_act2='none', Query_Linear_FC_drop=0.01, Output_bn_decay=0.1, Output_FC_act1='relu', Output_FC_act2='none', Output_FC_drop=0.01
Using device: cuda:0
trainX: torch.Size([4084, 8, 223])		 trainY: torch.Size([4084, 8, 223])
valX:   torch.Size([571, 8, 223])		valY:   torch.Size([571, 8, 223])
testX:   torch.Size([1156, 8, 223])		testY:   torch.Size([1156, 8, 223])
mean:   31.8979		std:   10.7164
data loaded!
compiling model...
fourier_filter: 9 parameters
  ├─ distribution_correction: 8 parameters
traffic_linear: 4,544 parameters
  ├─ convs: 4,544 parameters
query_linear: 4,608 parameters
  ├─ convs: 4,608 parameters
nav_attention: 25,536 parameters
  ├─ W_q: 4,288 parameters
  ├─ W_k: 4,288 parameters
  ├─ W_v: 4,288 parameters
  ├─ mapping: 4,288 parameters
  ├─ fusion: 8,384 parameters
st_embedding: 21,824 parameters
  ├─ FC_se: 8,576 parameters
  ├─ FC_te: 13,248 parameters
encoder_blocks: 151,074 parameters
  ├─ 0: 151,074 parameters
transform_attn: 17,152 parameters
  ├─ FC_q: 4,288 parameters
  ├─ FC_k: 4,288 parameters
  ├─ FC_v: 4,288 parameters
  ├─ FC: 4,288 parameters
decoder_blocks: 151,074 parameters
  ├─ 0: 151,074 parameters
output_layer: 4,355 parameters
  ├─ convs: 4,355 parameters
trainable parameters: 380,176
**** training model ****
2025-08-25 15:23:36 | epoch: 0001/100, training time: 56.1s, inference time: 2.0s
train loss: 2.8116, val_loss: 2.2696
val loss decrease from inf to 2.2696, saving model to ./save_model/grid_24_33/Model_GF_test.pkl
2025-08-25 15:24:32 | epoch: 0002/100, training time: 54.7s, inference time: 1.9s
train loss: 2.5230, val_loss: 2.2504
val loss decrease from 2.2696 to 2.2504, saving model to ./save_model/grid_24_33/Model_GF_test.pkl
2025-08-25 15:25:29 | epoch: 0003/100, training time: 54.9s, inference time: 1.9s
train loss: 2.4590, val_loss: 2.1436
val loss decrease from 2.2504 to 2.1436, saving model to ./save_model/grid_24_33/Model_GF_test.pkl
2025-08-25 15:26:33 | epoch: 0004/100, training time: 61.5s, inference time: 1.9s
train loss: 2.4336, val_loss: 2.1528
2025-08-25 15:27:35 | epoch: 0005/100, training time: 60.3s, inference time: 1.9s
train loss: 2.3832, val_loss: 2.0708
val loss decrease from 2.1436 to 2.0708, saving model to ./save_model/grid_24_33/Model_GF_test.pkl
2025-08-25 15:28:31 | epoch: 0006/100, training time: 54.2s, inference time: 1.9s
train loss: 2.3403, val_loss: 2.1000
2025-08-25 15:29:26 | epoch: 0007/100, training time: 53.6s, inference time: 1.9s
train loss: 2.3608, val_loss: 2.0770
2025-08-25 15:30:22 | epoch: 0008/100, training time: 53.8s, inference time: 1.9s
train loss: 2.3455, val_loss: 2.0536
val loss decrease from 2.0708 to 2.0536, saving model to ./save_model/grid_24_33/Model_GF_test.pkl
2025-08-25 15:31:17 | epoch: 0009/100, training time: 53.4s, inference time: 1.9s
train loss: 2.3695, val_loss: 2.1127
2025-08-25 15:32:13 | epoch: 0010/100, training time: 53.9s, inference time: 1.9s
train loss: 2.3331, val_loss: 2.0767
2025-08-25 15:33:09 | epoch: 0011/100, training time: 54.4s, inference time: 1.9s
train loss: 2.3167, val_loss: 2.0894
2025-08-25 15:34:07 | epoch: 0012/100, training time: 55.4s, inference time: 1.9s
train loss: 2.3199, val_loss: 2.0959
2025-08-25 15:35:05 | epoch: 0013/100, training time: 56.1s, inference time: 1.9s
train loss: 2.3176, val_loss: 2.0460
val loss decrease from 2.0536 to 2.0460, saving model to ./save_model/grid_24_33/Model_GF_test.pkl
2025-08-25 15:36:03 | epoch: 0014/100, training time: 55.9s, inference time: 1.9s
train loss: 2.3200, val_loss: 2.0776
2025-08-25 15:37:01 | epoch: 0015/100, training time: 56.5s, inference time: 1.9s
train loss: 2.3146, val_loss: 2.0726
2025-08-25 15:37:57 | epoch: 0016/100, training time: 53.9s, inference time: 1.9s
train loss: 2.3049, val_loss: 2.0684
2025-08-25 15:38:53 | epoch: 0017/100, training time: 54.5s, inference time: 1.9s
train loss: 2.2843, val_loss: 2.0503
2025-08-25 15:39:50 | epoch: 0018/100, training time: 54.8s, inference time: 1.9s
train loss: 2.2829, val_loss: 2.0597
2025-08-25 15:40:44 | epoch: 0019/100, training time: 52.2s, inference time: 1.9s
train loss: 2.2671, val_loss: 2.0719
2025-08-25 15:41:38 | epoch: 0020/100, training time: 52.2s, inference time: 1.9s
train loss: 2.2639, val_loss: 2.0750
2025-08-25 15:42:32 | epoch: 0021/100, training time: 52.3s, inference time: 1.9s
train loss: 2.2803, val_loss: 2.0480
2025-08-25 15:43:26 | epoch: 0022/100, training time: 52.0s, inference time: 1.9s
train loss: 2.2407, val_loss: 2.0345
val loss decrease from 2.0460 to 2.0345, saving model to ./save_model/grid_24_33/Model_GF_test.pkl
2025-08-25 15:44:24 | epoch: 0023/100, training time: 55.9s, inference time: 1.9s
train loss: 2.2320, val_loss: 2.0754
2025-08-25 15:45:17 | epoch: 0024/100, training time: 51.2s, inference time: 1.9s
train loss: 2.2114, val_loss: 2.0668
2025-08-25 15:46:10 | epoch: 0025/100, training time: 51.6s, inference time: 1.9s
train loss: 2.2483, val_loss: 2.0658
2025-08-25 15:47:04 | epoch: 0026/100, training time: 51.9s, inference time: 1.9s
train loss: 2.2158, val_loss: 2.0436
2025-08-25 15:47:58 | epoch: 0027/100, training time: 51.7s, inference time: 1.9s
train loss: 2.2205, val_loss: 2.0606
2025-08-25 15:48:53 | epoch: 0028/100, training time: 53.2s, inference time: 1.9s
train loss: 2.2097, val_loss: 2.0564
2025-08-25 15:49:50 | epoch: 0029/100, training time: 55.2s, inference time: 1.9s
train loss: 2.2203, val_loss: 2.1266
2025-08-25 15:50:43 | epoch: 0030/100, training time: 51.1s, inference time: 1.8s
train loss: 2.2321, val_loss: 2.1312
2025-08-25 15:51:36 | epoch: 0031/100, training time: 51.3s, inference time: 1.8s
train loss: 2.2384, val_loss: 2.0537
2025-08-25 15:52:29 | epoch: 0032/100, training time: 51.5s, inference time: 1.8s
train loss: 2.2026, val_loss: 2.1679
early stop at epoch: 0032
Training completed. Best model saved to ./save_model/grid_24_33/Model_GF_test.pkl
**** testing model ****
loading model from ./save_model/grid_24_33/Model_GF_test.pkl
model loaded!
evaluating...
train MAE: 1.9779, RMSE: 3.0041, MAPE: 6.87%
performance in each prediction step (train)
step 1: MAE=1.6936, RMSE=2.5158, MAPE=5.80%
step 2: MAE=1.9719, RMSE=2.9764, MAPE=6.81%
step 3: MAE=2.0016, RMSE=3.0387, MAPE=6.94%
step 4: MAE=2.0052, RMSE=3.0522, MAPE=6.97%
step 5: MAE=2.0135, RMSE=3.0698, MAPE=7.01%
step 6: MAE=2.0250, RMSE=3.0916, MAPE=7.06%
step 7: MAE=2.0425, RMSE=3.1216, MAPE=7.13%
step 8: MAE=2.0695, RMSE=3.1666, MAPE=7.24%
average: MAE=1.9779, RMSE=3.0041, MAPE=6.87%
val MAE: 2.1682, RMSE: 3.3241, MAPE: 7.53%
performance in each prediction step (val)
step 1: MAE=1.8095, RMSE=2.7123, MAPE=6.21%
step 2: MAE=2.1427, RMSE=3.2478, MAPE=7.42%
step 3: MAE=2.2021, RMSE=3.3706, MAPE=7.65%
step 4: MAE=2.2188, RMSE=3.4157, MAPE=7.72%
step 5: MAE=2.2296, RMSE=3.4439, MAPE=7.77%
step 6: MAE=2.2411, RMSE=3.4616, MAPE=7.81%
step 7: MAE=2.2479, RMSE=3.4686, MAPE=7.83%
step 8: MAE=2.2540, RMSE=3.4723, MAPE=7.84%
average: MAE=2.1682, RMSE=3.3241, MAPE=7.53%
test MAE: 2.1947, RMSE: 3.3720, MAPE: 7.61%
performance in each prediction step (test)
step 1: MAE=1.8546, RMSE=2.8182, MAPE=6.36%
step 2: MAE=2.1763, RMSE=3.3193, MAPE=7.52%
step 3: MAE=2.2292, RMSE=3.4224, MAPE=7.74%
step 4: MAE=2.2424, RMSE=3.4531, MAPE=7.79%
step 5: MAE=2.2523, RMSE=3.4712, MAPE=7.83%
step 6: MAE=2.2612, RMSE=3.4862, MAPE=7.87%
step 7: MAE=2.2674, RMSE=3.4977, MAPE=7.89%
step 8: MAE=2.2741, RMSE=3.5077, MAPE=7.92%
average: MAE=2.1947, RMSE=3.3720, MAPE=7.61%
total testing time: 19.3s
total time: 30.7min
